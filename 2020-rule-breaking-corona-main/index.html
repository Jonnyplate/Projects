<!-- 
    this file runs the experiment
-->

<!DOCTYPE html>
<html lang="en">
<head>
    <title>Insert Experiment Name Here</title>
    <meta charset="UTF-8">
    <!-- CSS -->
    <link rel="stylesheet" href="JSPsych-master/css/jspsych.css">

    <!--- Pavlovia ? -->

    <!-- plugins -->
    <script src="JSPsych-master/jspsych.js"></script>
    <script src='JSPsych-master/plugins/jquery.min.js'></script>
    <script src="JSPsych-master/plugins/jspsych-html-keyboard-response.js"></script>
    <script src="JSPsych-master/plugins/jspsych-image-keyboard-response.js"></script>
    <script src="JSPsych-master/plugins/jspsych-html-button-response.js"></script>
    <script src="JSPsych-master/plugins/jspsych-survey-likert.js"></script>
    <script src="JSPsych-master/plugins/jspsych-survey-text.js"></script>
    <script src="JSPsych-master/plugins/jspsych-survey-multi-choice.js"></script>

    <script src="jspsych-rule-violation.js"></script>
    <!-- ... -->

    <!-- custom experiment files -->
    <script src="ExperimentFiles/functions.js"></script>
    <script src="ExperimentFiles/setup.js"></script>
    <script src="ExperimentFiles/instructions.js"></script>
    <script src="ExperimentFiles/survey.js"></script>
    <script src="ExperimentFiles/trials.js"></script>
</head>
<body>
<script>
/* pavlovia */
//...

/* experiment parts */

var welcome = {
    timeline: [
        welcome_1,
        //welcome, consent, ...
        //demographics
    ]
}

timeline.push(welcome);

// Hier Instruktionen
timeline.push(instruction_1)
timeline.push(practice_1)

timeline.push(instruction_2)
timeline.push(practice_2)

timeline.push(instruction_end)
timeline.push(main_experiment)


var ending = {
    timeline: [
        //debriefing, ...
    ],
}

//timeline.push(ending);

/* #####################################################################
            Run the experiment
##################################################################### */

jsPsych.init({
    timeline: timeline,
    preload_images: images,
    use_webaudio: false,
    on_trial_finish: function(data) {
        data.exp_part = exp_part_current;
        //....
    },
    on_interaction_data_update: function() {
        // console.log(n_blur);
        let get_interactions = jsPsych.data.getInteractionData();
        let interaction_data = JSON.parse(get_interactions.json());
        let last_event = interaction_data[interaction_data.length - 1];
        if (!pause) {
            if (last_event["event"] === "blur") {
                n_blur ++;
            }
            if (n_blur > 2) {
                consent = false;
                console.log("exiting the experiment");
                jsPsych.endExperiment('<p><strong>Ende</strong></p>' +
                    'Leider haben Sie das Fenster mehr als ein mal verlassen. ' +
                    'Daher mussten wir das Experiment leider vorzeitig beenden.');
            }
        }
    },
    on_finish: function() {
        jsPsych.data.displayData();
    }
});

</script>

</body>
</html>








